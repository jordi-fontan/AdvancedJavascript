Ensuring immutability: ESLint
Selecting transcript lines in this section will navigate to timestamp in the video
- [Instructor] So, I talked in the previous video about the importance of immutability in functional programming. Immutability allows us to avoid the many bugs that occur in computer programs as a side effect of state change. It also means that we don't have to worry about using private variables to avoid changes coming from unexpected places, since we simply can't make changes to any piece of data. That being said, if we want to ensure complete immutability in JavaScript, there's something we need to keep in mind. While using the const keyword prevents us from directly changing the value of a piece of data, for example if we say const x equals five, we can't simply say x equals six, since this will throw an error. However, using const in JavaScript is a little funny when working with arrays and objects. For example, if we define an array called numbers, like this, const numbers, one two three four five, we can never directly redefine numbers as a different array like this, numbers equals hello. But we can modify the individual elements of an array like this. Numbers zero equals 100. And JavaScript won't complain about this at all, even though we've defined our numbers array using the const keyword. Also, if we're not careful, we can accidentally call a mutating array method such as reverse, on a supposedly immutable array like this. Numbers dot reverse, and this will actually modify the original array without any complaint from JavaScript. And the same is true for objects as well. If we define an object called person, const person, with name and age properties, name John Doe, age 34, we can never directly redefine person as another object like this, person equals name Bob, but if we try and reset a property of our object like this, person dot name equals Bob, JavaScript won't complain even though this is modifying our data. Now, I'm going to show you an approach that we can use to prevent mutation in our code, and this is by using ESLint rules. If you've never worked with or heard of ESLint before, it's an extremely helpful tool that helps you catch errors or stylistic flaws in your code. ESLint won't add anything extra to your code, we can simply run it and it looks at our existing code and tells us any problems it finds, for example if we're doing accidental mutation. Now there are many different ESLint plugins that we can use depending on our coding style and concerns, there are ones that check for correct indentation, ones that make sure you put semicolons at the end of every line, et cetera. But for the purposes of this course, the Lint rules we're interested in are the ones that will automatically tell us if we try and mutate anything in our code. There are several existing plugins that already implement this functionality, and the one we're going to use is called ESLint plugin immutable. I'm not going to go through all the details about ESLint here, but I'll just walk you through the steps required to get this set up.

  Ensuring immutability: Install ESLint
Selecting transcript lines in this section will navigate to timestamp in the video
- [Instructor] The first thing we're going to do is open up a terminal inside our Exercise Files folder. I'm going to use the integrated terminal inside inside VS Code, but you're more than welcome to use Mac's built in terminal as well. And then, inside our Exercise Files folder, we're going to initialize an npm package with npm init -y. Once we've done that, we'll install ESLint as a dev dependency by typing `npm install --save-dev eslint `. Then we'll initialize ESLint for our project by running npx eslint --init, and then it's going to ask us a series of questions, so we'll answer those, and to make things easy on ourselves, we're going to select Use a popular style guide, when it asks, How would you like to define a style for your project? This enables us to use a predefined set of rules. And we're going to select Airbnbs. And now we see that ESLint created this eslintrc.js file for us. This file tells ESLint what to look for in our code.


  Ensuring immutability: Finalize ESLint
Selecting transcript lines in this section will navigate to timestamp in the video
The next thing we're going to do is install the eslint plugin immutable package for our project. So in the terminal, we'll type npm install dash dash save-dev eslint-plugin dash immutable and hit enter, and then all have to do is add some of these rules to our eslint rc file. So we'll open up eslintrc.js and add a plugins property right above rules. Plugins, and it's going to be an array, and then we simply add our immutable package to it. Like this: immutable, and don't forget to add the commas. Then, inside the rules object, we're going to add a rule from immutable. Specifically, we're going to use the immutable slash no dash mutation rule. And we're going to give it the value two because we want eslint to treat this as an error if it finds it, not just a warning, which would be one. And for those of you who are wondering, if we want to specifically disable a rule, we could set this value to zero like this. But we're going to leave it as two. Let's save our file, as well. So now, if we delete all this code, and rewrite some code that we might find when we're accidentally mutating our data, like this, const person equals name John Doe, and age equals 34, and then we try and mutate the name property, person dot name equals Bob, and then we save our code, and then if we go into our terminal and type npx eslint, and then the directory that we want to run lint on, in this case, just the current directory we were in, so we'll use dot, and hit enter, we see that, in addition to a few other lint errors, eslint also gives us an error saying that no object mutation is allowed. Keep in mind also that if you don't want to use the default rules from Airbnb, you can go into your eslint rc, and simply delete extends:'airbnb-base' from the object. But I'm going to leave it in there. So there you have it. When we're creating a functional code base and want to ensure that we don't accidentally mutate any of our data, we can set up eslint to catch any mutations for us.
